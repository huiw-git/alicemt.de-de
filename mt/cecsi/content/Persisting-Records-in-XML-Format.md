---
title: "Persisting Records in XML Format"
ms.custom: na
ms.date: 05/16/2016
ms.reviewer: na
ms.suite: na
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: f3113ec4-ae31-428f-89c6-bc1024f128ea
caps.latest.revision: 16
caps.handback.revision: 16
manager: sonalm
translation.priority.ht: 
  - de-de
  - es-es
  - fr-fr
  - it-it
  - ja-jp
  - ko-kr
  - pt-br
  - ru-ru
  - zh-cn
  - zh-tw
---
# Persisting Records in XML Format
<?xml version="1.0" encoding="utf-8"?>
<caps:SxS xmlns:caps="http://schemas.microsoft.com/build/caps/2013/11">
  <caps:SxSTarget locale="de-DE">
    <developerConceptualDocument xsi:schemaLocation="http://ddue.schemas.microsoft.com/authoring/2003/5 http://dduestorage.blob.core.windows.net/ddueschema/developer.xsd" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <introduction>
        <para>
          <caps:sentence sentenceid="abc7f93ffc1176ed6e51119d4a11bfbe" id="tgt1" class="tgtSentence">Like ADTG format, <legacyBold>Recordset</legacyBold> persistence in XML format is implemented with the Microsoft OLE DB Persistence Provider.</caps:sentence>
          <caps:sentence sentenceid="832b5e8d44e71edcbc3b5200fda4e8bd" id="tgt2" class="tgtSentence"> This provider generates a forward-only, read-only rowset from a saved XML file or stream that contains the schema information generated by ADO.</caps:sentence>
          <caps:sentence sentenceid="0685c1c05a31ec9bbf0957a56848ebc6" id="tgt3" class="tgtSentence"> Similarly, it can take an ADO <legacyBold>Recordset</legacyBold>, generate XML, and save it to a file or any object that implements the COM <legacyBold>IStream</legacyBold> interface.</caps:sentence>
          <caps:sentence sentenceid="f1a1410992996cb0a49d91a5616c15be" id="tgt4" class="tgtSentence"> (In fact, a file is just another example of an object that supports <legacyBold>IStream</legacyBold>.)</caps:sentence>
          <caps:sentence sentenceid="c819e7fa7efae9f38804ef3de34af6dd" id="tgt5" class="tgtSentence"> For versions 2.5 and later, ADO relies on the Microsoft XML Parser (MSXML) to load the XML into the <legacyBold>Recordset</legacyBold>; therefore msxml.dll is required.</caps:sentence>
        </para>
        <alert class="note">
          <para>
            <caps:sentence sentenceid="e0d633d621cd5057f5babbadd2964b38" id="tgt6" class="tgtSentence">Some limitations apply when saving hierarchical <legacyBold>Recordsets</legacyBold> (data shapes) to XML format.</caps:sentence>
            <caps:sentence sentenceid="09ac65ec861ccf32e86a12f0afd42962" id="tgt7" class="tgtSentence"> You cannot save to XML if the hierarchical <legacyBold>Recordset</legacyBold> contains pending updates, and you cannot save a parameterized hierarchical <legacyBold>Recordset</legacyBold>.</caps:sentence>
            <caps:sentence sentenceid="a01ddcbe44cb21e3a0eb20614d585743" id="tgt8" class="tgtSentence"> For more information, see <link xlink:href="d01aeb4d-4e43-450b-b3f2-0c27eaaf9f86">Persisting Filtered and Hierarchical Recordsets</link>.</caps:sentence>
          </para>
        </alert>
        <para>
          <caps:sentence sentenceid="974cb7632b359252972bfe150ad7ba63" id="tgt9" class="tgtSentence">The easiest way to persist data into XML and load it back again through ADO is with the <legacyBold>Save</legacyBold> and <legacyBold>Open</legacyBold> methods, respectively.</caps:sentence>
          <caps:sentence sentenceid="9c4ed9b75ea95790fe629fbeb8cdfef7" id="tgt10" class="tgtSentence"> The following ADO code example demonstrates saving the data in the <legacyBold>Titles</legacyBold> table to a file that is named titles.sav.</caps:sentence>
        </para>
        <code>Dim rs as new Recordset
Dim rs2 as new Recordset
Dim c as new Connection
Dim s as new Stream

' Query the Titles table.
c.Open "provider=sqloledb;data source=MySQLServer;initial catalog=pubs;Integrated Security='SSPI'"
rs.cursorlocation = adUseClient
rs.Open "select * from titles", c, adOpenStatic

' Save to the file in the XML format. Note that if you don't specify 
' adPersistXML, a binary format (ADTG) will be used by default.
rs.Save "titles.sav", adPersistXML

' Save the recordset into the ADO Stream object.
rs.save s, adPersistXML
rs.Close
c.Close

set rs = nothing

' Reopen the file.
rs.Open "titles.sav",,,,adCmdFile
' Open the Stream back into a Recordset.
rs2.open s</code>
        <para>
          <caps:sentence sentenceid="12301dca65fcbc0c302637fa5318d0a2" id="tgt11" class="tgtSentence">ADO always persists the entire <legacyBold>Recordset</legacyBold> object.</caps:sentence>
          <caps:sentence sentenceid="d828ee1aa0e121d7e1cb6feef44abbeb" id="tgt12" class="tgtSentence"> If you want to persist a subset of rows of the <legacyBold>Recordset</legacyBold> object, use the <legacyBold>Filter</legacyBold> method to narrow down the rows or change your selection clause.</caps:sentence>
          <caps:sentence sentenceid="f787678271a5a3e411a6b1c6cd80908d" id="tgt13" class="tgtSentence"> However, you must open a <legacyBold>Recordset</legacyBold> object with a client-side cursor (<legacyBold>CursorLocation</legacyBold> = <legacyBold>adUseClient</legacyBold>) to use the <legacyBold>Filter</legacyBold> method for saving a subset of rows.</caps:sentence>
          <caps:sentence sentenceid="5e0715c7a8df3b556423ae2d22084511" id="tgt14" class="tgtSentence"> For example, to retrieve titles that start with the letter "b," you can apply a filter to an open <legacyBold>Recordset</legacyBold> object:</caps:sentence>
        </para>
        <code>rs.Filter "title_id like 'B*'"
rs.Save "btitles.sav", adPersistXML</code>
        <para>
          <caps:sentence sentenceid="9713c346b44d329df3d284a2381e541a" id="tgt15" class="tgtSentence">ADO always uses the Client Cursor Engine rowset to produce a scrollable, bookmarkable <legacyBold>Recordset</legacyBold> object on top of the forward-only data generated by the Persistence Provider.</caps:sentence>
        </para>
        <para>
          <caps:sentence sentenceid="8bb3138ef5145ffb4733f64e5d3dd6e6" id="tgt16" class="tgtSentence">This section contains the following topics.</caps:sentence>
        </para>
        <list class="bullet">
          <listItem>
            <para>
              <link xlink:href="6e146738-ac4d-47bb-b6cd-d87b2260aead">XML Persistence Format</link>
            </para>
          </listItem>
          <listItem>
            <para>
              <link xlink:href="efff5569-db52-451d-a039-2e74870534da">Namespaces</link>
            </para>
          </listItem>
          <listItem>
            <para>
              <link xlink:href="4ac6e524-2c92-48e8-b871-0a4b5c8fda18">Schema Section</link>
            </para>
          </listItem>
          <listItem>
            <para>
              <link xlink:href="43dc42a8-7057-48e6-93d6-880d5c5c51a4">Data Section</link>
            </para>
          </listItem>
          <listItem>
            <para>
              <link xlink:href="5d4b11c4-c94f-4910-b99b-5b9abc50d791">Hierarchical Recordsets in XML</link>
            </para>
          </listItem>
          <listItem>
            <para>
              <link xlink:href="52f8e379-812a-4db8-9210-94458926301c">Recordset Dynamic Properties in XML</link>
            </para>
          </listItem>
          <listItem>
            <para>
              <link xlink:href="1a46196e-839f-4734-a59e-2c64609ffb9e">XSLT Transformations</link>
            </para>
          </listItem>
          <listItem>
            <para>
              <link xlink:href="4d20fd28-aaf8-4232-83ce-f9d1e5f93dae">Saving to the XML DOM Object</link>
            </para>
          </listItem>
          <listItem>
            <para>
              <link xlink:href="fadbd38e-6e7b-4b81-96ea-85169c664374">XML Security Considerations</link>
            </para>
          </listItem>
          <listItem>
            <para>
              <caps:sentence sentenceid="b2506f47ece4da4f4057f524818c5119" id="tgt17" class="tgtSentence">
                <link xlink:href="353d569a-043a-4397-9ee6-564c4af8d5f6">XML Recordset Persistence Scenario</link> </caps:sentence>
            </para>
          </listItem>
        </list>
      </introduction>
      <relatedTopics></relatedTopics>
    </developerConceptualDocument>
  </caps:SxSTarget>
  <caps:SxSSource locale="en-US">
    <developerConceptualDocument xsi:schemaLocation="http://ddue.schemas.microsoft.com/authoring/2003/5 http://dduestorage.blob.core.windows.net/ddueschema/developer.xsd" xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <introduction>
        <para>
          <caps:sentence id="src1" class="srcSentence">Like ADTG format, <legacyBold>Recordset</legacyBold> persistence in XML format is implemented with the Microsoft OLE DB Persistence Provider.</caps:sentence>
          <caps:sentence id="src2" class="srcSentence"> This provider generates a forward-only, read-only rowset from a saved XML file or stream that contains the schema information generated by ADO.</caps:sentence>
          <caps:sentence id="src3" class="srcSentence"> Similarly, it can take an ADO <legacyBold>Recordset</legacyBold>, generate XML, and save it to a file or any object that implements the COM <legacyBold>IStream</legacyBold> interface.</caps:sentence>
          <caps:sentence id="src4" class="srcSentence"> (In fact, a file is just another example of an object that supports <legacyBold>IStream</legacyBold>.)</caps:sentence>
          <caps:sentence id="src5" class="srcSentence"> For versions 2.5 and later, ADO relies on the Microsoft XML Parser (MSXML) to load the XML into the <legacyBold>Recordset</legacyBold>; therefore msxml.dll is required.</caps:sentence>
        </para>
        <alert class="note">
          <para>
            <caps:sentence id="src6" class="srcSentence">Some limitations apply when saving hierarchical <legacyBold>Recordsets</legacyBold> (data shapes) to XML format.</caps:sentence>
            <caps:sentence id="src7" class="srcSentence"> You cannot save to XML if the hierarchical <legacyBold>Recordset</legacyBold> contains pending updates, and you cannot save a parameterized hierarchical <legacyBold>Recordset</legacyBold>.</caps:sentence>
            <caps:sentence id="src8" class="srcSentence"> For more information, see <link xlink:href="d01aeb4d-4e43-450b-b3f2-0c27eaaf9f86">Persisting Filtered and Hierarchical Recordsets</link>.</caps:sentence>
          </para>
        </alert>
        <para>
          <caps:sentence id="src9" class="srcSentence">The easiest way to persist data into XML and load it back again through ADO is with the <legacyBold>Save</legacyBold> and <legacyBold>Open</legacyBold> methods, respectively.</caps:sentence>
          <caps:sentence id="src10" class="srcSentence"> The following ADO code example demonstrates saving the data in the <legacyBold>Titles</legacyBold> table to a file that is named titles.sav.</caps:sentence>
        </para>
        <code>Dim rs as new Recordset
Dim rs2 as new Recordset
Dim c as new Connection
Dim s as new Stream

' Query the Titles table.
c.Open "provider=sqloledb;data source=MySQLServer;initial catalog=pubs;Integrated Security='SSPI'"
rs.cursorlocation = adUseClient
rs.Open "select * from titles", c, adOpenStatic

' Save to the file in the XML format. Note that if you don't specify 
' adPersistXML, a binary format (ADTG) will be used by default.
rs.Save "titles.sav", adPersistXML

' Save the recordset into the ADO Stream object.
rs.save s, adPersistXML
rs.Close
c.Close

set rs = nothing

' Reopen the file.
rs.Open "titles.sav",,,,adCmdFile
' Open the Stream back into a Recordset.
rs2.open s</code>
        <para>
          <caps:sentence id="src11" class="srcSentence">ADO always persists the entire <legacyBold>Recordset</legacyBold> object.</caps:sentence>
          <caps:sentence id="src12" class="srcSentence"> If you want to persist a subset of rows of the <legacyBold>Recordset</legacyBold> object, use the <legacyBold>Filter</legacyBold> method to narrow down the rows or change your selection clause.</caps:sentence>
          <caps:sentence id="src13" class="srcSentence"> However, you must open a <legacyBold>Recordset</legacyBold> object with a client-side cursor (<legacyBold>CursorLocation</legacyBold> = <legacyBold>adUseClient</legacyBold>) to use the <legacyBold>Filter</legacyBold> method for saving a subset of rows.</caps:sentence>
          <caps:sentence id="src14" class="srcSentence"> For example, to retrieve titles that start with the letter "b," you can apply a filter to an open <legacyBold>Recordset</legacyBold> object:</caps:sentence>
        </para>
        <code>rs.Filter "title_id like 'B*'"
rs.Save "btitles.sav", adPersistXML</code>
        <para>
          <caps:sentence id="src15" class="srcSentence">ADO always uses the Client Cursor Engine rowset to produce a scrollable, bookmarkable <legacyBold>Recordset</legacyBold> object on top of the forward-only data generated by the Persistence Provider.</caps:sentence>
        </para>
        <para>
          <caps:sentence id="src16" class="srcSentence">This section contains the following topics.</caps:sentence>
        </para>
        <list class="bullet">
          <listItem>
            <para>
              <link xlink:href="6e146738-ac4d-47bb-b6cd-d87b2260aead">XML Persistence Format</link>
            </para>
          </listItem>
          <listItem>
            <para>
              <link xlink:href="efff5569-db52-451d-a039-2e74870534da">Namespaces</link>
            </para>
          </listItem>
          <listItem>
            <para>
              <link xlink:href="4ac6e524-2c92-48e8-b871-0a4b5c8fda18">Schema Section</link>
            </para>
          </listItem>
          <listItem>
            <para>
              <link xlink:href="43dc42a8-7057-48e6-93d6-880d5c5c51a4">Data Section</link>
            </para>
          </listItem>
          <listItem>
            <para>
              <link xlink:href="5d4b11c4-c94f-4910-b99b-5b9abc50d791">Hierarchical Recordsets in XML</link>
            </para>
          </listItem>
          <listItem>
            <para>
              <link xlink:href="52f8e379-812a-4db8-9210-94458926301c">Recordset Dynamic Properties in XML</link>
            </para>
          </listItem>
          <listItem>
            <para>
              <link xlink:href="1a46196e-839f-4734-a59e-2c64609ffb9e">XSLT Transformations</link>
            </para>
          </listItem>
          <listItem>
            <para>
              <link xlink:href="4d20fd28-aaf8-4232-83ce-f9d1e5f93dae">Saving to the XML DOM Object</link>
            </para>
          </listItem>
          <listItem>
            <para>
              <link xlink:href="fadbd38e-6e7b-4b81-96ea-85169c664374">XML Security Considerations</link>
            </para>
          </listItem>
          <listItem>
            <para>
              <caps:sentence id="src17" class="srcSentence">
                <link xlink:href="353d569a-043a-4397-9ee6-564c4af8d5f6">XML Recordset Persistence Scenario</link> </caps:sentence>
            </para>
          </listItem>
        </list>
      </introduction>
      <relatedTopics></relatedTopics>
    </developerConceptualDocument>
  </caps:SxSSource>
</caps:SxS>